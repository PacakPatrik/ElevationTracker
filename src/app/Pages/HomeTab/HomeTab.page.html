<ion-header [translucent]="true">
  <ion-toolbar >
    <ion-title >
      <img class="titleImage" src="assets/images/mountain-icon.png">
      Highker
    </ion-title>


    <ion-buttons slot="end">
      <!-- Tlačítkem otevřu stránku nastavení -->
      <ion-button (click)="openSettings()">
        <ion-icon name="cog" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="{{settingService.settingsArray[2]}}">
  <ion-header collapse="condense" >
    <ion-toolbar >
      <ion-title size="large">Home</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-grid class="row-container">
    <!-- First Row -->
    <ion-row class="row-item">
      <ion-col size="12" class="center">
        <ion-img src="/assets/images/mountain-icon.png" class="mountain-icon" />

      </ion-col>
      <p class="current-elevation">Current elevation:</p>
    </ion-row>

    <ion-row class="row-item">
      <ion-col size="12">
        <div class="ion-text-center elevation-container">
          <ng-container *ngIf="elevation$ | async as elevation; else loadingOrPlaceholder">
            <div class="elevation-text-container">
              <p class="elevation-text">{{ elevation?.results?.[0]?.elevation}} </p>
              <p class="sea-level">{{settingService.settingsArray[1]}} above sea level</p>
              <ion-row>
                <ion-col size="6" class="last">
              <p>Last update   <br>  {{storageService.sessionTimeStamps[storageService.sessionTimeStamps.length-1]}}</p>

                </ion-col>
                <ion-col size="6" class="last" *ngIf="storageService.sessionData[storageService.sessionData.length - 2];else notAvailableData">
                  <p>Last elevation {{
                      storageService.sessionData[storageService.sessionData.length - 2]
                    }}</p>
                </ion-col>
                <ng-template #notAvailableData>
                  <ion-col size="6" class="last">
                    <p>Last elevation <br> not yet available</p>
                  </ion-col>

                </ng-template>
              </ion-row>
            </div>
          </ng-container>
          <ion-item class="chart" *ngIf="this.storageService.sessionData.length !== 0; else noSession">
            <div>
              <canvas id="myChart" ></canvas>
            </div>
          </ion-item>
          <ng-template #noSession>
            <!-- HTML to be generated when sessionArray[0] is null -->
            <ion-item>
              <p class="noData">
                No session data available. Start tracking to see graph of your latest activity
              </p>
              <!-- Add other HTML elements specific to the null scenario -->
            </ion-item>
          </ng-template>
          <ng-template #loadingOrPlaceholder>
            <p class="elevation-text">_ _ _</p>
            <p class="loading-text">To get elevation data, push "Start Tracking"</p>
          </ng-template>
        </div>
      </ion-col>
    </ion-row>

    <!-- Second Row -->
    <ion-row class="row-item">
      <ion-col size="12" class="ion-text-center">
        <ion-button [color]="buttonColor" (click)="toggleTracking()">
          <ion-icon name="disc-outline"></ion-icon>
          {{ buttonText }}
        </ion-button>
      </ion-col>
      <ion-col size="12" class="ion-text-center">
        <!-- <ion-button color="danger">
           <ion-icon name="stop-circle-outline"></ion-icon>
           Stop tracking
         </ion-button>-->
       </ion-col>
     </ion-row>


  </ion-grid>
  <ion-segment color="dark" class="separator">
    <ion-icon name="chevron-up-outline" class="separator-icon" color="primary"></ion-icon>
  </ion-segment>
  <ion-list>
    <div class="background">
    <ion-item-group class="statsHeader2">
      <h2>Last Session:</h2>
        <ion-item>
          <ion-item-divider>
            <ion-icon name="trending-up-outline" class="statsIconsLast"></ion-icon>
            <h4>Highest Point:</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>
          <ion-label>
            {{ this.statsService.highestPointLastSession }}
            {{  settingService.settingsArray[1] }}
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-item-divider>
            <ion-icon name="resize-outline" class="statsIconsLast"></ion-icon>
            <h4>Elevation change:</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>
          <ion-label>{{this.statsService.elevationChangeLastSession}}
            {{ settingService.settingsArray[1]}}
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-item-divider>
            <ion-icon name="trending-down-outline" class="statsIconsLast"></ion-icon>
            <h4>Lowest Point:</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>
          <ion-label>{{this.statsService.lowestPointLastSession}}
            {{  settingService.settingsArray[1] }}
          </ion-label>
        </ion-item>
    </ion-item-group>
      </div>
    <ion-item-group class="statsHeader2">
      <h2>Overall:</h2>
      <ion-radio-group >
        <ion-item>
          <ion-item-divider>
            <ion-icon name="trending-up-outline" class="statsIconsOverall"></ion-icon>
            <h4>Highest Point:</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>

          <ion-label>{{this.statsService.highestPointOverall}}
            {{  settingService.settingsArray[1] }}
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-item-divider>
            <ion-icon name="resize-outline" class="statsIconsOverall"></ion-icon>
            <h4>Highest Elevation Change</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>
          <ion-label>{{this.statsService.overallElevationChange}}
            {{  settingService.settingsArray[1] }}
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-item-divider>
            <ion-icon name="trending-down-outline" class="statsIconsOverall"></ion-icon>
            <h4>Lowest Point:</h4>
          </ion-item-divider>
        </ion-item>
        <ion-item>
          <ion-label>{{this.statsService.lowestPointOverall}}
            {{  settingService.settingsArray[1] }}
          </ion-label>
        </ion-item>
      </ion-radio-group>
    </ion-item-group>
  </ion-list>

</ion-content>
